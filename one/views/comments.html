<!doctype html>
<html>
<head>
<!-- 新 Bootstrap 核心 CSS 文件 -->
<link rel="stylesheet" href="http://cdn.bootcss.com/bootstrap/3.2.0/css/bootstrap.min.css">

<!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
<script src="http://cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>

<!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
<script src="http://cdn.bootcss.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<style>
#title{
	text-align:center;
}
#title a:hover{
	text-decoration:none;
}
.hidden{
	display:none;
}
td,tr{
	word-break:break-all;
	max-height:100px;
	overflow:hidden;
}
td:nth-child(1){
	width:6%;
}
td:nth-child(2),td:nth-child(4){
	width:14%;
}
td:nth-child(3){
	width:29.5%;
}
td:nth-child(5){
	width:15%;
}
#form{
	position:absolute;
	padding:4px 9px;
background: #f3fcff;
padding: 9px 14px;
font-family: 微软雅黑;
border: 1px solid rgba(0,0,0,.2);
-webkit-border-radius: 6px;
-moz-border-radius: 6px;
-o-border-radius: 6px;
-ms-border-radius: 6px;
border-radius: 6px;
-webkit-box-shadow: 0 5px 10px rgba(0,0,0,.2);
-moz-box-shadow: 0 5px 10px rgba(0,0,0,.2);
-o-box-shadow: 0 5px 10px rgba(0,0,0,.2);
-ms-box-shadow: 0 5px 10px rgba(0,0,0,.2);
box-shadow: 0 5px 10px rgba(0,0,0,.2);
}
#page_div{
	text-align:center;
}
#add_message{
	position:fixed;
	top:40px;
	left:40px;
	display:inline-block;
	width:30px;
	height:30px;
	cursor:pointer;
	text-align:center;
}
#add_form{
	position:absolute;
	padding:4px 9px;
	width:300px;
	height:208px;
background: #f3fcff;
padding: 9px 14px;
font-family: 微软雅黑;
border: 1px solid rgba(0,0,0,.2);
-webkit-border-radius: 6px;
-moz-border-radius: 6px;
-o-border-radius: 6px;
-ms-border-radius: 6px;
border-radius: 6px;
-webkit-box-shadow: 0 5px 10px rgba(0,0,0,.2);
-moz-box-shadow: 0 5px 10px rgba(0,0,0,.2);
-o-box-shadow: 0 5px 10px rgba(0,0,0,.2);
-ms-box-shadow: 0 5px 10px rgba(0,0,0,.2);
box-shadow: 0 5px 10px rgba(0,0,0,.2);

overflow:hidden;

-webkit-transition:all 0.3s ease-out;
-moz-transition:all 0.3s ease-out;
-o-transition:all 0.3s ease-out;
-ms-transition:all 0.3s ease-out;
transition:all 0.3s ease-out;
}
#add_form.width_height_0{
-webkit-transition:all 0.3s ease-out;
-moz-transition:all 0.3s ease-out;
-o-transition:all 0.3s ease-out;
-ms-transition:all 0.3s ease-out;
transition:all 0.3s ease-out;

	width:0px;
	height:0px;
	padding:0px;
}
#pen{
	display:block;
	width:100%;
	height:100%;
}
#add_form textarea{
	height:80px;
}
.left{
	float:left;
	width:49%;
}
.right{
	float:right;
	width:49%;
}
</style>
</head>
<body>
	<div class="container">
		<h1  id="title"><a href="/comments">write page</a></h1>
			<table class="table table-hover table-bordered">	
				<tr>
					<th>index</th>
					<th>name</th>
					<th>content</th>
					<th>to</th>
					<th>about</th>
					<th>data</th>
					<th>handle</th>
				</tr>
				<% comments.forEach(function(comment){ %>
					<tr>
						<td><%= comment.id %></td>
						<td class="name"><%= comment.name %></td>
						<td class="content"><%= comment.content %></td>
						<td><%= comment.t %></td>
						<td><%= comment.about %></td>
						<td><%= comment.d %></td>
						<td class="" style="position:;">
							<button type="button" class="reply btn btn-success">Reply</button>
						</td>
					</tr>
				<% }) %>


			</table>

	<hr />
	<div id="page_div">
		<ul class="pagination">
			<li><a href="#">&laquo;</a></li>
			<% pages.forEach(function(page){ %>
				<li><a href="/comments?page=<%= page+1 %>"><%= page+1 %></a></li>
			<% }) %>
			 <li><a href="#">&raquo;</a></li>
		</ul>
	</div>
	<div id="add_message">
		<span id="pen" class="glyphicon glyphicon-pencil"> </span>
		<div id="add_form" class="width_height_0">
			<form id="add_message_form" class="" method="post" >
				<input id="add_name" name="name" class="form-control" placeholder="name" />
				<br />
				<textarea id="add_content" name="content" class="form-control" placeholder="message"></textarea>
				<br />
				<div>
					<div class="left">
						<input type="button" value="cancel" id="cancel" class="form-control" />
					</div>
					<div class="right">
						<input type="submit" value="submit" id="add_submit" class="form-control" />
					</div>
				</div>
			</form>
		</div>
	</div>
</div>
<script>
$(".reply").click(function(){
	if($(this).parent().find("div").length){
		$(this).parent().find("div").remove();
		//alert("hide");
	}else{
		//alert("show");
		$div=$('<div id="form"><form method="post" action=""><fieldset><input id="name" type="text" name="name" class="form-control" placeholder="your name" /><br /><textarea name="content" id="content" class="form-control" placeholder="your context"></textarea><br /><input id="submit" type="submit" value="submit" class="form-control" /></fieldset></form></div>');
		$(".reply").parent().find("div").remove();
		var $input=$("<input name='tName' type='hidden' value='"+$(this).parent().parent().find(".name").text()+"' />")
		$div.find("form").append($input);
		$input=$("<input type='hidden' name='tContent' value='"+$(this).parent().parent().find(".content").text()+"' />")
		$div.find("form").append($input);
		$(this).parent().append($div);

		$("#form").on("keydown",function(event){
			if(event.ctrlKey&&event.keyCode==13){
				var content=$("#content").val().trim();
				var name=$("#name").val().trim();
				if(content==""||name==""){
					alert("name or content is empty!");
					return false;
				}else{
					$("#submit").click();
				}
			}
		})

		$("#submit").on("click",function(e){
			var content=$("#content").val().trim();
			var name=$("#name").val().trim();
			if(content==""||name==""){
				alert("name or content is empty!");
				e.preventDefault();
				return false;
			}else{

			}
		})	
	}


})

$("#add_submit").click(function(e){
	var name=$("#add_name").val().trim();
	var content=$("#add_content").val().trim();
	if(name==""||content==""){
		e.preventDefault();
		alert("name or content is empty!");
		return false;
	}
})
$("#cancel").click(function(){
	$("#add_form").addClass("width_height_0");
})

$("#pen").click(function(){
	$("#add_form").removeClass("width_height_0");
})

$("#add_form").on("keydown",function(event){
			if(event.ctrlKey&&event.keyCode==13){
				var content=$("#add_content").val().trim();
				var name=$("#add_name").val().trim();
				if(content==""||name==""){
					alert("name or content is empty!");
					return false;
				}else{
					$("#add_submit").click();
				}
			}
})
</script>
<script src="../scroll.js"></script>
</body>
</html>